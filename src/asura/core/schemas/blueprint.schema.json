{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://asura.local/schemas/blueprint.schema.json",
    "title": "ASURA Blueprint Schema (v0.1)",
    "type": "object",
    "additionalProperties": false,
    "required": ["schema_version", "document_id", "theme_id", "toc", "slides"],
    "properties": {
      "schema_version": { "type": "string", "const": "0.1" },
      "document_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
      "theme_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
      "toc": {
        "type": "array",
        "items": { "$ref": "#/$defs/toc_item" }
      },
      "slides": {
        "type": "array",
        "minItems": 1,
        "maxItems": 100,
        "items": { "$ref": "#/$defs/slide" }
      }
    },
    "$defs": {
      "bbox_pt": {
        "type": "array",
        "minItems": 4,
        "maxItems": 4,
        "items": { "type": "number" }
      },
      "citation": {
        "type": "object",
        "additionalProperties": false,
        "required": ["mark", "page", "chunk_id"],
        "properties": {
          "mark": { "type": "string", "pattern": "^â€»[0-9]+$" },
          "page": { "type": "integer", "minimum": 1 },
          "chunk_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
          "bbox_pt": { "$ref": "#/$defs/bbox_pt" }
        }
      },
      "slot_value": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "array",
            "items": { "type": "string" }
          }
        ]
      },
      "slide": {
        "type": "object",
        "additionalProperties": false,
        "required": ["component_id", "slots", "citations"],
        "properties": {
          "slide_no": { "type": ["integer", "null"], "minimum": 1 },
          "component_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
          "message": { "type": "string" },
          "slots": {
            "type": "object",
            "additionalProperties": { "$ref": "#/$defs/slot_value" }
          },
          "citations": {
            "type": "array",
            "minItems": 1,
            "items": { "$ref": "#/$defs/citation" }
          }
        }
      },
      "toc_item": {
        "type": "object",
        "additionalProperties": false,
        "required": ["title", "level"],
        "properties": {
          "title": { "type": "string", "minLength": 1 },
          "level": { "type": "integer", "minimum": 0, "maximum": 10 },
          "slide_index": { "type": ["integer", "null"], "minimum": 1 }
        }
      }
    }
  }
{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://asura.local/schemas/extraction.schema.json",
    "title": "ASURA Extraction Schema (v0.1)",
    "type": "object",
    "additionalProperties": false,
    "required": ["schema_version", "document", "chunks"],
    "properties": {
      "schema_version": { "type": "string", "const": "0.1" },
      "document": {
        "type": "object",
        "additionalProperties": false,
        "required": ["document_id", "source_type", "page_count"],
        "properties": {
          "document_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
          "source_type": { "type": "string", "enum": ["pdf", "docx", "pptx"] },
          "source_path": { "type": "string", "minLength": 1 },
          "converted_pdf_path": { "type": "string" },
          "title": { "type": "string" },
          "page_count": { "type": "integer", "minimum": 1 }
        }
      },
      "chunks": {
        "type": "array",
        "minItems": 1,
        "items": { "$ref": "#/$defs/chunk" }
      }
    },
    "$defs": {
      "bbox_pt": {
        "type": "array",
        "minItems": 4,
        "maxItems": 4,
        "items": { "type": "number" }
      },
      "chunk": {
        "type": "object",
        "additionalProperties": false,
        "required": ["chunk_id", "text", "normalized_text"],
        "properties": {
          "chunk_id": { "type": "string", "pattern": "^[a-zA-Z0-9_\\-]{1,64}$" },
          "type": { "type": "string", "enum": ["text"] },
          "page": { "type": "integer", "minimum": 1 },
          "slide": { "type": "integer", "minimum": 1 },
          "bbox_pt": { "$ref": "#/$defs/bbox_pt" },
          "bbox": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "x": { "type": "number" },
              "y": { "type": "number" },
              "w": { "type": "number", "minimum": 0 },
              "h": { "type": "number", "minimum": 0 }
            },
            "required": ["x", "y", "w", "h"]
          },
          "heading_level": { "type": "integer", "minimum": 0, "maximum": 10 },
          "text": { "type": "string" },
          "normalized_text": { "type": "string" },
          "docx_paragraph_id": { "type": "string" },
          "hash": { "type": "string", "minLength": 8 },
          "numbers": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      }
    }
  }